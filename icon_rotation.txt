Giải pháp 2: Tự động chia lại (Auto Normalize/Rescale) - Thông minh nhấtCách này cho phép người dùng nhập thoải mái, hệ thống sẽ tự động "co dãn" các record cũ để nhường chỗ cho record mới.Logic:Giữ nguyên giá trị của record MỚI (vì người dùng vừa nhập, đó là ý muốn của họ).Tính phần trăm còn lại cho các record CŨ.Chia tỷ lệ lại các record cũ.Ví dụ:Đang có: A (50%), B (50%). Tổng 100%.Người dùng thêm C (20%).Phần còn lại cho A và B là: $100\% - 20\% = 80\%$.Tỷ lệ co dãn (Scale Factor): $80 / 100 = 0.8$.Giá trị mới của A: $50 * 0.8 = 40\%$.Giá trị mới của B: $50 * 0.8 = 40\%$.Kết quả: A(40) + B(40) + C(20) = 100%.Code Logic PHP:PHPpublic function storeAndRescale($newPrizePercent) {
    $this->db->beginTransaction();
    
    // 1. Lấy tất cả record cũ
    $oldPrizes = $this->db->query("SELECT id, percent FROM prizes")->fetchAll();
    
    // 2. Tính hệ số co dãn (Scale Factor)
    // Ví dụ: Mới chiếm 20%, thì Cũ chỉ còn 80% không gian.
    $remainingSpace = 100 - $newPrizePercent;
    
    // Tính tổng cũ để xem cần co bao nhiêu
    $oldTotal = array_sum(array_column($oldPrizes, 'percent'));
    
    if ($oldTotal > 0) {
        $scaleFactor = $remainingSpace / $oldTotal;
        
        // 3. Update tất cả record cũ
        foreach ($oldPrizes as $prize) {
            $newVal = $prize['percent'] * $scaleFactor;
            $this->db->query("UPDATE prizes SET percent = $newVal WHERE id = " . $prize['id']);
        }
    }
    
    // 4. Lưu record mới
    $this->db->insert('prizes', ['percent' => $newPrizePercent]);
    
    $this->db->commit();
}
